rule_id: AK-001
name: read_only_agent_write_operation
description: >
  Detects when an agent with a read-only declared type performs a write,
  delete, or execute operation. Indicates capability escalation â€” either
  prompt injection or misconfiguration.
severity: high
category: capability_escalation
layer: 1
phase: 0
requires_baseline: false
safe_mode_compatible: true

match:
  conditions:
    - field: agent_type
      in: ["summarizer", "analyzer", "reader", "reporter", "search", "retriever", "monitor"]
    - field: actions[*].tool_category
      contains_any: ["write", "delete", "execute"]
  logic: ALL

response:
  alert: true
  recommended_action: >
    Review agent configuration. Check for prompt injection in recent inputs.
    Verify the agent's tool manifest matches its declared intent.

tags:
  - capability_escalation
  - prompt_injection_indicator
