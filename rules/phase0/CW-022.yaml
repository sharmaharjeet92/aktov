rule_id: CW-022
name: burst_of_failed_tool_calls
description: >
  Detects 3+ consecutive failed tool calls within a single trace.
  May indicate brute-force attempts, permission probing, or a
  malfunctioning agent.
severity: medium
category: chain_anomaly
layer: 1
phase: 0
requires_baseline: false
safe_mode_compatible: true

match:
  consecutive:
    field: actions[*].outcome.status
    in: ["failure", "error"]
    min_count: 3
  logic: ALL

response:
  alert: true
  recommended_action: >
    Review the error pattern. Check if the agent is probing for access
    or if there's a systemic issue causing repeated failures.

tags:
  - chain_anomaly
  - brute_force
  - error_burst
